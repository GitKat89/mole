{% extends 'mole_classifier/base.html' %} {% block title %} Mole Classifier Home {% endblock %} {% block content %}
<header class="text-center">
    <h1 class="display-4">Mole Classifier</h1>

</header>
<div class="row py-4">
    <div class="col-lg-6 mx-auto">
        <form method="POST" class="input-group mb-3 px-2 py-2 rounded-pill bg-white shadow-sm" action="{% url 'analyze' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <input id="uploadInput" class="form-control border-0" onchange="readURL(this);" type="file" name="myfile">
            <button class="btn btn-light m-0 rounded-pill px-4" type="submit">Analyse</button>

        </form>
        <!-- Uploaded image area-->
        <p class="font-italic  text-center"> The image uploaded will be rendered inside the box below.</p>
        
        <div class="image-area mt-4">
            <img id="imageResult" src="#" alt="" class="img-fluid rounded shadow-sm mx-auto d-block">
        </div>
    </div>
</div>
<!-- diagram -->
<div id="chartArea" class="col-sm-7" style="margin: auto;" align="center">
    <div id="probabilities" class="chart-container" style="position: relative;">
        <canvas id="myChart"></canvas>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"         crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"         crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"         crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js">

</script>
<script>
/*AKIEC - Actinic Keratosis / Morbus Bowen / Intraepithelial Carcinoma
BCC - Basal Cell Carcinoma
BKL - Benign pigmented keratosis / Seborrheic Keratosis / Solar Lentigo
DF - Dermatofibroma
MEL - Melanoma
NV - Nevus
SCC - Squamous Cell Carcinoma
VASC - Vascular Lesion (incl. Hemorrhage) */

    var result = JSON.parse("{{result}}" ) ;
    var ctx = document.getElementById("myChart");
    var probabilityChart = new Chart(ctx, {
        type: 'bar',
        responsive: true,
        data: {
            labels: ["Actinic Keratosis", "Basal Cell Carcinoma", "Benign pigmented keratosis", "Dermatofibroma", "Melanoma", "Nevus", "Squamous Cell Carcinoma", "Vascular Lesion"],
            datasets: [{
                label: 'Softmax',
                data: result,
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            },
            legend: {
                display: true
            }

        }
    });
</script>

<script>
    /*  ==========================================
    SHOW UPLOADED IMAGE
* ========================================== */


    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#imageResult')
                    .attr('src', e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    /* IF BUTTON ANALYZED IS CLICKED ...
        $(function () {
            $('#uploadInput').on('change', function () {
                readURL(input);
            });
        });
    */
    /*  ==========================================
        SHOW UPLOADED IMAGE NAME
    * ========================================== */
    
    var input = document.getElementById('upload');
    var infoArea = document.getElementById('upload-label');

    input.addEventListener('change', showFileName);
    function showFileName(event) {
        var input = event.srcElement;
        var fileName = input.files[0].name;
        infoArea.textContent = 'File name: ' + fileName;
    }

</script> {% endblock %}